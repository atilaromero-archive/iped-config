version: '2.1'
services:
  iped:
    image: deepcase/iped:debian-3.12.4-NIOFS-4
    working_dir: $PWD
    user: $UID
    volumes:
      - ../:$PWD/..
      - ./:/usr/local/src/iped/iped/target/release/conf/
      - ${TMP-/tmp/}:/tmp/
      - /tmp/.X11-unix/:/tmp/.X11-unix/
    environment:
      - DISPLAY
      - GDK_BACKEND
      - IMAGE=$IMAGE
      - OUTPUT=${OUTPUT-../IPED}
      - Xmx=${Xmx-100G}
    command: bash -xc 'mkdir -p "$$OUTPUT" && java -Djava.awt.headless=true -Xmx"$$Xmx" -jar /iped/iped.jar -d "$$IMAGE" -o "$$OUTPUT" --nologfile --nogui --portable | tee -a "$$OUTPUT"/IPED.log'
